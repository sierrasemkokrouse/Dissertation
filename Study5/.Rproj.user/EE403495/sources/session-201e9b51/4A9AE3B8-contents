---
title: "00_Creating-Dataset"
format: html
editor: visual
toc: TRUE
editor_options: 
  chunk_output_type: console
---

```{r, warning = F, message = F, include = F}
library(psych)
library(ggplot2)
library(effsize)
library(dplyr)
library(kableExtra)
library(GPArotation)
library(stats)
library(plyr)
library(psych)
library(tidyverse)
library("Hmisc")
library(forcats)
library(grid)
library(ggcorrplot)
library(corrplot)
library(gridExtra)
library("ggdark")
library(broom)
library("effects")
library(lsmeans)
library(emmeans)
library(diagram)
library(pwr)
library(dplyr)
library(tidyr)
library(nlme)
library(rstatix)
library(multcomp)
library(lme4)
library(lmerTest)
library(cowplot)
library(report)
library(sjPlot)
library(lavaan)
```

```{r, warning = F, message = F, include = F}
theme_perez <- function() {
    ggplot2::theme_bw() +
    ggplot2::theme(
      axis.text = element_text(colour = "black",  family = "Times New Roman", size = 12),
    axis.title = element_text(colour = "black", family = "Times New Roman", size = 13),
    legend.title = element_text(colour = "black", family = "Times New Roman", size = 13),
    legend.text = element_text(colour = "black", family = "Times New Roman", size = 12),
    plot.title = element_text(colour = "black", family = "Times New Roman", size = 13),
    plot.subtitle = element_text(colour = "black", family = "Times New Roman", size = 13),
    strip.text = element_text(colour = "black", family = "Times New Roman", size = 13))
}

horzi_theme <- theme(    #   remove the gray background
  panel.background    = element_rect( size=.1, colour="black", fill="white") ,
  #   make the major gridlines light gray and thin
  panel.grid.major.y  = element_line( size=.1, colour="#666666" ) ,
  #   suppress the vertical grid lines
  panel.grid.major.x  = element_blank() ,
  #   suppress the minor grid lines
  panel.grid.minor    = element_blank() ,
  #   add axes
  axis.line           = element_line( size=.2 , colour="#666666" ),
  #   adjust the axis ticks
  axis.ticks          = element_line( size=.1 , colour="#666666" ),
  #   move the y-axis over to the left
  #axis.title.y        = element_text( angle=90, vjust=.5, hjust=.5 ),
  #   increase margin moved-over y-axis label fits
  # plot.margin = unit( c(.5,.25,.25,.5) , "in") ,
  title = element_text(  size=12 ) ,
  axis.title.x = element_text( size=12 ) ,
  axis.title.y = element_text( size=12 ) ,
  axis.text.x = element_text( size=12 ) ,
  axis.text.y = element_text( size=12 )
)

horzi <- horzi_theme

stat_sum_df <- function(fun, geom="crossbar", ...) {
  stat_summary(fun.data=fun, colour="black", geom=geom, width=.5,  ...)
}

# define the dodge object for equivalent error bar and geom_bar
dodge <- position_dodge(width=0.9)

# define a geom_bar
bars <- geom_bar(stat="summary", fun.y="mean", position="dodge")
```

# Long

```{r, include=F}
study1 <- read.csv("Data_Processed_Study1.csv")
study2 <- read.csv("Data_Processed_Study2.csv")
study3 <- read.csv("Data_Processed_Study3.csv")
study4 <- read.csv("Data_Processed_Study4.csv")
```

```{r, include=F}
study1$study <- 1

study1 <- study2[-c(1,4:7)]

study1 <- 
  dplyr::rename(study1, 
                patient=condition,
                age_Self=age,
                gender_Self=gender,
                ladder_Self=ladder,
                income_Self=income,
                race_Self=race,
                politics_Self=politics,
                healthLit_Patient=healthLiteracyDave,
                insurance_Patient=insuranceDave,
                ed_Own=edOwn,
                ed_Mom=edMom,
                ed_Dad=edDad,
                ed_Patient=edDave)

study2 <- study2 %>% 
  filter(Condition=="Control")

study2$study <- 2

study2$manipulationCheck <- as.character(study2$manipulationCheck)

study2 <- 
  dplyr::rename(study2,
                politics_Self=politics_Own,
                patient=patientSESRace)

study2$gender_Self <- as.factor(study2$gender_Self)
levels(study2$gender_Self) <- c("Male", "Female", "Trans", "Non-Conform", "Other")

study12 <- bind_rows(study1, study2)
```

```{r}
study3$study <- 3

study3$patient <- case_when(study3$Condition == "BlackHighMale" ~ "Black High SES",
                              study3$Condition == "BlackHighFemale" ~ "Black High SES",
                              study3$Condition == "BlackLowMale" ~ "Black Low SES",
                              study3$Condition == "BlackLowFemale" ~ "Black Low SES",
                              study3$Condition == "WhiteHighMale" ~ "White High SES",
                              study3$Condition == "WhiteHighFemale" ~ "White High SES",
                              study3$Condition == "WhiteLowMale" ~ "White Low SES",
                              study3$Condition == "WhiteLowFemale" ~ "White Low SES",
                              TRUE ~ "NA")

study3$conditionSES <- case_when(study3$SES == "High" ~ "High SES",
                              study3$SES == "Low" ~ "Low SES",
                              TRUE ~ "NA")

study3 <- 
  dplyr::rename(study3,
                conditionRace=Race,
                politics_Self=politics_Own)

study3$gender_Self <- as.factor(study3$gender_Self)
levels(study3$gender_Self) <- c("Male", "Female", "Trans", "Non-Conform", "Other")

study3_male <- study3 %>% 
  filter(Gender=="Male")

data_male <- bind_rows(study12, study3_male)

data <- bind_rows(study12, study3)
```

```{r}
study4$study <- 4

study4 <- study4[-c(1,1:3)]

study4$conditionRace <- "White"

study4$conditionSES <- case_when(study4$SES == "High" ~ "High SES",
                              study4$SES == "Low" ~ "Low SES",
                              TRUE ~ "NA")

study4$gender_Self <- as.factor(study4$gender_Self)
levels(study4$gender_Self) <- c("Male", "Female", "Trans", "Non-Conform", "Other")
```

```{r}
data_FINAL <- bind_rows(data, study4)
```

```{r}
write.csv(data_FINAL, "Data_Processed_Study5.csv")
```

# Wide

```{r, include=F}
study1_wide <- read.csv("Data_Processed_Study1-Wide.csv")
study2_wide <- read.csv("Data_Processed_Study2-Wide.csv")
study3_wide <- read.csv("Data_Processed_Study3-Wide.csv")
study4_wide <- read.csv("Data_Processed_Study4-Wide.csv")
```

```{r}
study1_wide$study <- 1

study1_wide <- 
  dplyr::rename(study1_wide, 
                patient=condition,
                age_Self=age,
                gender_Self=gender,
                ladder_Self=ladder,
                income_Self=income,
                race_Self=race,
                politics_Self=politics,
                healthLit_Patient=healthLiteracyDave,
                insurance_Patient=insuranceDave,
                ed_Own=edOwn,
                ed_Mom=edMom,
                ed_Dad=edDad,
                ed_Patient=edDave)

study2_wide <- study2_wide %>% 
  filter(Condition == "Control")

study2_wide$study <- 2

study2_wide$manipulationCheck <- as.character(study2_wide$manipulationCheck)

study2_wide <- 
  dplyr::rename(study2_wide,
                politics_Self=politics_Own,
                patient=patientSESRace)

study2_wide$gender_Self <- as.factor(study2_wide$gender_Self)
levels(study3_wide$gender_Self) <- c("Male", "Female", "Trans", "Non-Conform", "Other")

study12_wide <- bind_rows(study1_wide, study2_wide)
```

```{r}
study3_wide$study <- 3

study3_wide$patient <- case_when(study3_wide$Condition == "BlackHighMale" ~ "Black High SES",
                              study3_wide$Condition == "BlackHighFemale" ~ "Black High SES",
                              study3_wide$Condition == "BlackLowMale" ~ "Black Low SES",
                              study3_wide$Condition == "BlackLowFemale" ~ "Black Low SES",
                              study3_wide$Condition == "WhiteHighMale" ~ "White High SES",
                              study3_wide$Condition == "WhiteHighFemale" ~ "White High SES",
                              study3_wide$Condition == "WhiteLowMale" ~ "White Low SES",
                              study3_wide$Condition == "WhiteLowFemale" ~ "White Low SES",
                              TRUE ~ "NA")

study3_wide$conditionSES <- case_when(study3_wide$SES == "High" ~ "High SES",
                              study3_wide$SES == "Low" ~ "Low SES",
                              TRUE ~ "NA")

study3_wide <- 
  dplyr::rename(study3_wide,
                conditionRace=Race,
                politics_Self=politics_Own)

study3_wide$gender_Self <- as.factor(study3_wide$gender_Self)
levels(study3_wide$gender_Self) <- c("Male", "Female", "Trans", "Non-Conform", "Other")

study4_wide_male <- study3_wide %>% 
  filter(Gender=="Male")

data_wide_male <- bind_rows(study12_wide, study3_wide_male)

data_wide <- bind_rows(study12_wide, study3_wide)
```

```{r}
study4_wide$study <- 4

study4_wide$conditionRace <- "White"

study4_wide$conditionSES <- case_when(study4_wide$SES == "High" ~ "High SES",
                              study4_wide$SES == "Low" ~ "Low SES",
                              TRUE ~ "NA")

study4_wide$gender_Self <- as.factor(study4_wide$gender_Self)
levels(study4_wide$gender_Self) <- c("Male", "Female", "Trans", "Non-Conform", "Other")

data_wide_FINAL <- bind_rows(data_wide, study4_wide)
```

```{r}
write.csv(data_wide_FINAL, "Data_Processed_Study5-Wide.csv")
```
